---
title: "KeysarMouseTracking.csv"
output: html_document
---

```{r}
setwd('~/Repos/psych254/replication_project/analysis/')
mouseD = read.csv('pilotBMouse.csv')
errorD = read.csv('pilotBError.csv')
messageD = read.csv('pilotBMessages.csv')
str(mouseD)
library(tidyr)
library(dplyr)
library(ggplot2)
```

Set up data

```{r}

mD <- messageD %>% 
  mutate(messageStamp = time) %>%
  select(gameid, condition, critical, objectSet,sender,contents,messageStamp) %>%
  distinct(gameid,contents)

joined <- (right_join(mouseD, mD, by = c("gameid", "condition", "objectSet", 
                                  "critical")))

dUnfilt <- joined %>%
  filter(critical == 1) %>%
  group_by(objectSet)

d <- joined %>% 
  filter(critical == 1) %>% 
  group_by(objectSet) %>%
  filter(time > messageStamp) #%>%
  mutate(begTargetX = first(targetX),
         begTargetY = 600-first(targetY),
         distractorX = as.factor(distractorX),
         distractorY = as.factor(distractorY)) %>%
  mutate(begDistrX = first(as.numeric(levels(distractorX))[distractorX]),
         begDistrY = 600-first(as.numeric(levels(distractorY))[distractorY]))
```


```{r}
d$new_labels = as.factor(sapply(X = d$objectSet, 
                              FUN = function(v) {return(paste("Item", v))}))

g <- (ggplot(d, aes(x = mouseX, y = 600-mouseY, color = condition)) +
      geom_vline(xintercept = c(0, 150,300,450, 600)) +
      geom_hline(yintercept = c(0, 150,300,450, 600)) +
      geom_point() +
      geom_point(aes(x = begTargetX, y = begTargetY, size = 10), 
                 shape = 4, color = "black", show_guide = FALSE) +
      geom_point(aes(x = begDistrX, y = begDistrY, size = 10),
                 shape = 4, color = "grey50", show_guide = FALSE) + 
      theme(panel.grid.major = element_blank(), 
            panel.grid.minor = element_blank()) +
      xlim(0, 600) +
      ylim(0, 600) +
      theme(aspect.ratio = 1) +
      facet_wrap(~ new_labels, nrow = 2))
g
```